function rsmg_check_width(e){var t=[];e("#rsmg_albums li").each(function(){if(responsive){var n=e(this).width()}else{var n=e(this).find(".rsmg_album_inner_container").width()}var r=e(this).find(".rsmg_special_title").val();r=r.trim();var i=album_image_data[r]*2;var s=0;if(i<=n){s=i;e(this).find(".rsmg_album_inner_container").css("max-width",s)}var o=s==0?e(this).width():s;e(this).find(".rsmg_title").css("max-width",o);t.push(e(this).find(".rsmg_title").height())});var n=Math.max.apply(Math,t);e("#rsmg_albums li").each(function(){e(this).find(".rsmg_title").height(n)})}function rsmg_center_albums(e){var t=[];var n=0;var r=0;e("#rsmg_albums li").each(function(){t.push(e(this).find(".rsmg_album_container").offset().top);if(n==0){if(responsive){n=e(this).width()}else{n=e(this).find(".rsmg_album_container").width()}}if(r==0){if(responsive){r=parseInt(e(this).css("margin-left"))}else{r=parseInt(e(this).css("margin-right"))}}if(responsive){var i=e(this).find(".rsmg_album_container").outerWidth();var s=e(this).width();var o=(s-i)/2;e(this).find(".rsmg_album_container").css("margin-left",o)}});var i=countOccurances(t);var s=0;for(var o=0;o<t.length;o++){if(s<i[t[o]]){s=i[t[o]]}}var u=e("#rsmg_main").width();var a=e("#rsmg_albums .rsmg_album_container").css("padding-left");a=a.substr(0,a.length-2);a=parseInt(a);var f=e("#rsmg_albums .rsmg_album_container").css("padding-right");f=f.substr(0,f.length-2);f=parseInt(f);var l=2;if(responsive){var c=n}else{var c=n+a+f+l+r}var h=Math.floor(u/c);if(t.length>=h){s=h}if(s==0)s=1;if(s==1){var p=0}else{var p=r*s}if(p==0)p=a+f+l;if(responsive){var d=(u-((n+p)*(s-1)+n))/2}else{var d=(u-c*s)/2}if(h>s&&!responsive){d=d+r}d=d>0?d:0;e("#rsmg_albums").css("margin-left",d)}function inner_center_responsive(e,t,n){e("#rsmg_gallery li").each(function(){if(e(this).css("display")!="none"&&e(this).css("clear")!="both"){var r=(n-t)/2;e(this).find(".rsmg_item_container").css("margin-left",r)}})}function rsmg_align_center(e,t){var n=[];var r=0;var i=0;var s=0;var o=0;var u=0;e("#rsmg_gallery li").each(function(){if(e(this).css("display")!="none"&&e(this).css("clear")!="both"){n.push(e(this).find(".rsmg_item_container").offset().top);if(r==0){if(responsive){r=e(this).width()}else{r=e(this).find(".rsmg_item_container").width()}}if(i==0){if(responsive){i=parseInt(e(this).css("margin-left"))}else{i=parseInt(e(this).css("margin-right"))}}if(responsive){if(u==0){s=e(this).width();o=e(this).find(".rsmg_item_container").outerWidth()}u++}}});if(responsive&&o!=0&&s!=0){inner_center_responsive(e,o,s)}var a=countOccurances(n);var f=0;for(var l=0;l<n.length;l++){if(f<a[n[l]]){f=a[n[l]]}}var c=e("#rsmg_main").width();var h=e("#rsmg_gallery .rsmg_item_container").css("padding-left");h=h.substr(0,h.length-2);h=parseInt(h);var p=e("#rsmg_gallery .rsmg_item_container").css("padding-right");p=p.substr(0,p.length-2);p=parseInt(p);var d=2;if(responsive){var v=r}else{var v=r+h+p+d+i}var m=Math.floor(c/v);if(n.length>=m){f=m}if(f==0)f=1;if(f==1){var g=0}else{var g=i}if(g==0)g=h+p+d;if(responsive){var y=(c-((r+g)*(f-1)+r))/2}else{var y=(c-v*f)/2}if(m>f&&!responsive){y=y+i}y=y>0?y:0;if(t){e("#rsmg_gallery").animate({marginLeft:y+"px"},500,function(){e(this).after(function(){return rsmg_init_same_mix_size(e)})})}else{e("#rsmg_gallery").css("margin-left",y)}}function countOccurances(e){var t={};for(var n=0;n<e.length;n++){var r=e[n];t[r]=t[r]?t[r]+1:1}return t}function rsmg_add_lang(e,t){if(typeof e=="object"){for(j in e)rsmg_lang_vars[j]=e[j];return true}return rsmg_lang_vars[e]=t}function rsmg_get_lang(e,t){if(typeof rsmg_lang_vars[e]!="undefined"){val=rsmg_lang_vars[e];if(t){if(val.indexOf("%s")>-1)val=val.replace("%s",t);else if(val.indexOf("%d")>-1)val=val.replace("%d",t)}return val}return e}function rsmg_set_tags_filters(e){var t=[];e("#rsmg_gallery li").each(function(){var n=e(this).attr("class");if(n){n=n.split(" ");if(n.length>0){for(var r=0;r<n.length;r++){if(n[r]!="mix"&&n[r]!="mix_all"){t.push(n[r])}}}}});if(t.length>0){var n=t.filter(function(e,n){return t.indexOf(e)==n});var r=e("#rsmg_gallery_filters").length;if(r>0){e("#rsmg_gallery_filters li").each(function(){var t=e(this).attr("data-filter");if(t!="all"){if(n.indexOf(t)>-1){e(this).fadeIn(600)}}})}}}function rsmg_init_load_more(e){if(e("#rsmg_load_more").length>0){var t=e("#rsmg_load_more").attr("rel");var n=0;var r=e("ul#rsmg_gallery li .rsmg_item_container").length;if(t>0)n=t-r;if(n<0)n=0;e("#rsmg_load_more").attr("rel",n);e("#rsmg_load_more").html(rsmg_get_lang("COM_RSMEDIAGALLERY_LOAD_MORE",e("#rsmg_load_more").attr("rel")));e("#rsmg_load_more").click(function(t){t.preventDefault();t.shiftKey?rsmg_get_items(e,false,{limitall:1,limit:e("#rsmg_load_more").attr("rel")}):rsmg_get_items(e)});e(document).keydown(function(t){if(t.shiftKey)e("#rsmg_load_more").html(rsmg_get_lang("COM_RSMEDIAGALLERY_LOAD_ALL",e("#rsmg_load_more").attr("rel")))});e(document).keyup(function(t){e("#rsmg_load_more").html(rsmg_get_lang("COM_RSMEDIAGALLERY_LOAD_MORE",e("#rsmg_load_more").attr("rel")))})}}function rsmg_get_original_limitstart(e){return parseInt(e("#rsmg_original_limitstart").val())}function rsmg_init_items(e,t){e("#rsmg_gallery li img").hover(function(){e(this).stop().animate({opacity:.7},"slow")},function(){e(this).stop().animate({opacity:1},"slow")});if(typeof rsmg_init_lightbox2=="function"){rsmg_init_lightbox2()}if(center_list){rsmg_align_center(e,false)}if(!t){rsmg_init_equal_size(e)}else{rsmg_init_same_mix_size(e)}}function rsmg_init_equal_size(e){if(!responsive){var t=0;var n=[];if(e(".rsmg_item_container").length==0)return;var r=e(".rsmg_item_container").offset().top;var i=e(".rsmg_item_container").length-1;e(".rsmg_item_container").each(function(s,o){var u=e(o).offset().top;if(r!=u){for(var a=0;a<n.length;a++)if(t>0)n[a].css("height",t);u=e(o).offset().top;r=u;t=0;n.length=0}t=Math.max(t,e(o).height());n.push(e(o));if(s==i){for(var a=0;a<n.length;a++)if(t>0)n[a].css("height",t)}})}else{rsmg_equal_size_responsive(e,false,0)}}function rsmg_equal_size_responsive(e,t,n){var r=[];var i=[];e("#rsmg_gallery li .rsmg_item_container").each(function(){var t=e(this).parent().attr("id");if(e(this).parent().css("display")!="none"&&t!="rsmg_loader_container"){r.push(Math.round(e(this).offset().top));items_offsets={};items_offsets.top=Math.round(e(this).offset().top);items_offsets.bottom=items_offsets.top+e(this).find(".rsmg_image").height();if(e(this).find(".rsmg_image_details")&&e(this).find(".rsmg_image_details").css("display")!="none"){items_offsets.bottom=items_offsets.bottom+e(this).find(".rsmg_image_details").outerHeight()}if(e(this).find(".rsmg_item_rest")&&e(this).find(".rsmg_item_rest").css("display")!="none"){items_offsets.bottom=items_offsets.bottom+e(this).find(".rsmg_item_rest").outerHeight()}i.push(items_offsets)}});var s=countOccurances(r);for(var o=0;o<i.length;o++){i[o].row=s[i[o].top]}var u={};for(var o=0;o<i.length;o++){if(!u[i[o].top]){u[i[o].top]=rsmg_get_bottoms(e,i,s[i[o].top],i[o].top)}}var a=0;e("#rsmg_gallery li .rsmg_item_container").each(function(){var t=e(this).parent().attr("id");if(e(this).parent().css("display")!="none"&&t!="rsmg_loader_container"){a++}});var f=0;e("#rsmg_gallery li .rsmg_item_container").each(function(){var r=e(this).parent().attr("id");if(e(this).parent().css("display")!="none"&&r!="rsmg_loader_container"){var i=Math.round(e(this).offset().top);var o=e(this).width();if(s[i]>1){var l=Math.max.apply(null,u[i]);var c=l-i;if(c>0){if(t){f++;if(f==a){e(this).animate({height:c+"px"},500,function(){rsmg_margin_left_responsive(e,t,n)})}else e(this).animate({height:c+"px"},500)}else{e(this).height(c)}e(this).find(".rsmg_image_details").css("max-width",o)}}else{var h=0;if(e(this).find(".rsmg_image")&&e(this).find(".rsmg_image").css("display")!="none"){h=h+e(this).find(".rsmg_image").height()}if(e(this).find(".rsmg_image_details")&&e(this).find(".rsmg_image_details").css("display")!="none"){h=h+e(this).find(".rsmg_image_details").outerHeight()}if(e(this).find(".rsmg_item_rest")&&e(this).find(".rsmg_item_rest").css("display")!="none"){h=h+e(this).find(".rsmg_item_rest").outerHeight()}if(t){f++;if(f==a){e(this).animate({height:h+"px"},500,function(){rsmg_margin_left_responsive(e,t,n)})}else e(this).animate({height:h+"px"},500)}else{e(this).height(h)}e(this).find(".rsmg_image_details").css("max-width",o)}}});if(!t)rsmg_margin_left_responsive(e,t,n)}function rsmg_margin_left_responsive(e,t,n){var r=[];var i=[];e("#rsmg_gallery li .rsmg_item_container").each(function(){var t=e(this).parent().attr("id");if(e(this).parent().css("display")!="none"&&t!="rsmg_loader_container"){r.push(Math.round(e(this).offset().top));i.push(e(this).parent())}});var s=rsmg_break_array(e,r);e.each(s,function(n,r){var s=n;e.each(r,function(e,n){var r=itemsrow*s+e;if(i[r]){var o=parseInt(i[r].css("margin-left"));if(e!=0){if(o==0){if(t){i[r].css("-webkit-transition","margin-left linear 0.3s");i[r].css("-moz-transition","margin-left linear 0.3s");i[r].css("-o-transition","margin-left linear 0.3s");i[r].css("transition","margin-left linear 0.3s")}i[r].removeClass("margin_left_none")}}else{if(o!=0){if(t){i[r].css("-webkit-transition","margin-left linear 0.3s");i[r].css("-moz-transition","margin-left linear 0.3s");i[r].css("-o-transition","margin-left linear 0.3s");i[r].css("transition","margin-left linear 0.3s")}i[r].addClass("margin_left_none")}}}})});if(n==0){if(t){setTimeout(function(){rsmg_equal_size_responsive(e,t,1)},400)}else{rsmg_equal_size_responsive(e,t,1)}}}function rsmg_break_array(e,t){var n=[];t=t.sort(function(e,t){return e-t});var r=countOccurances(t);var i=0;var s=0;e.each(r,function(e,r){n[s]=t.slice(i,i+r);i=i+r;s++});return n}function rsmg_get_bottoms(e,t,n,r){var i=[];for(var s=0;s<t.length;s++){if(t[s].row==n&&t[s].top==r){i.push(t[s].bottom)}}return i}function inArray(e,t){var n=t.length;for(var r=0;r<n;r++){if(t[r]==e)return true}return false}function rsmg_init_same_mix_size(e){if(responsive){rsmg_equal_size_responsive(e,true,0)}else{var t=[];e("#rsmg_gallery li").each(function(){if(e(this).css("display")=="block"||e(this).css("display")=="list-item"){t.push(e(this).find(".rsmg_item_container").offset().top)}});var n=t.filter(function(e,n){return t.indexOf(e)==n});for(var r=0;r<n.length;r++){var i=[];e("#rsmg_gallery li").each(function(){if(e(this).css("display")=="block"||e(this).css("display")=="list-item"){if(n[r]==e(this).find(".rsmg_item_container").offset().top){var t=e(this).find(".rsmg_item_container").find(".rsmg_title").outerHeight();var s=e(this).find(".rsmg_item_container").find(".rsmg_item_description").height();var o=e(this).find(".rsmg_item_container").find("a > img").height();var u=o+t+s+22;i.push(u)}}});var s=Math.max.apply(null,i);e("#rsmg_gallery li").each(function(){if(e(this).css("display")=="block"||e(this).css("display")=="list-item"){if(n[r]==e(this).find(".rsmg_item_container").offset().top){e(this).find(".rsmg_item_container").animate({height:s+"px"},500)}}})}}}function rsmg_get_items_filter(e,t,n){var r=e("ul#rsmg_gallery li .rsmg_item_container").length;if(n){var i={limitstart:r+rsmg_get_original_limitstart(e),Itemid:e("#rsmg_itemid").val(),tag:e("#selectedTag").val()}}else{var i={limitstart:r+rsmg_get_original_limitstart(e),Itemid:e("#rsmg_itemid").val()}}if(t)for(var s in t)i[s]=t[s];return i}function rsmg_min_max_occourences(e){var t=[];e("#rsmg_gallery li .rsmg_item_container").each(function(){var n=e(this).parent().attr("id");if(e(this).css("display")!="none"&&n!="rsmg_loader_container"){t.push(e(this).offset().top)}});var n=countOccurances(t);var r=[];for(var i=0;i<t.length;i++){r.push(n[t[i]])}var s=Math.min.apply(null,r);var o=Math.max.apply(null,r);var u={min:s,max:o};return u}function rsmg_get_items(e,t,n,r,i){var s=e("#rsmg_load_more").hasClass("rsmg_album_layout");var o=e("#rsmg_gallery");if(t==true)o.empty();if(i===false)i=false;else i=true;if(s){urlPost=rsmg_get_root()+"/index.php?option=com_rsmediagallery&task=getItemsAlbum&format=raw"}else{urlPost=rsmg_get_root()+"/index.php?option=com_rsmediagallery&task=getitems&format=raw"}e.ajax({type:"POST",url:urlPost,data:rsmg_get_items_filter(e,n,s),async:i,beforeSend:function(){var t=e("<li>",{id:"rsmg_loader_container"});if(responsive){t.addClass("span"+Math.floor(12/itemsrow));offset_data=rsmg_min_max_occourences(e);if(offset_data.min==offset_data.max){t.addClass("margin_left_none")}}var n=e("<div>",{"class":"rsmg_item_container"});if(responsive){n.width("100%")}t.append(n);o.append(t);e("#rsmg_load_more").fadeOut(500)},success:function(t){e("#rsmg_loader_container").remove();if(typeof t=="object"&&t.items&&t.total){var n=t.animation?t.animation:false;var i=o.find(".rsmg_item_container").length;var s=[];e(t.items).each(function(t,r){s.push(r.thumb);var u=e("<li>");if(responsive){u.addClass("span"+Math.floor(12/itemsrow));offset_data=rsmg_min_max_occourences(e);if(offset_data.min==offset_data.max){u.addClass("margin_left_none")}}if(n!=0){u.addClass("mix "+r.niceTags+" mix_all");u.css({display:"inline-block",opacity:"1"})}var a=e("<div>",{"class":"rsmg_item_container"});if(responsive){var f=e("<div>",{"class":"rsmg_image"})}var l=e("<a>",{href:r.href,"class":"rsmg_lightbox",rel:"{'link': '"+r.full+"', 'title': '#rsmg_item_"+i+"', 'id': '"+r.id+"', 'group' : 'all'}"});if(r.open_in_new_page)l.attr("target","_blank");var c=e("<img>",{src:r.thumb,alt:r.title});if(!responsive){c.attr({width:r.thumb_width,height:r.thumb_height});c.css({width:r.thumb_width,height:r.thumb_height})}l.append(c);var h="";if(responsive){var p="";if(r.show_title_list==1){p=e("<div>",{"class":"rsmg_image_details"})}}if(r.show_title_list==1){h=e("<a>",{href:r.href,"class":"rsmg_title"}).html(r.title);if(r.open_in_new_page)h.attr("target","_blank")}var d="";if(r.show_description_list==1)d=e("<span>",{"class":"rsmg_item_description"}).html(r.description);var v=e("<div>",{id:"rsmg_item_"+i}).css("display","none");if(responsive){v.addClass("rsmg_item_rest")}if(r.show_title_detail==1)v.append(e("<h2>",{"class":"rsmg_title"}).html(r.title));if(r.show_description_detail==1)v.append(r.full_description);var m="";if(r.download_original==1){m=e("<div>",{"class":"rsmg_download rsmg_toolbox"});a_download_original=e("<a>",{href:r.download}).html(rsmg_get_lang("COM_RSMEDIAGALLERY_DOWNLOAD"));m.append(a_download_original)}var g="";if(r.show_hits==1)g=e("<div>",{"class":"rsmg_views rsmg_toolbox"}).html(rsmg_get_lang(r.hits==1?"COM_RSMEDIAGALLERY_HIT":"COM_RSMEDIAGALLERY_HITS",r.hits));var y="";if(r.show_created==1)y=e("<div>",{"class":"rsmg_calendar rsmg_toolbox"}).html(rsmg_get_lang("COM_RSMEDIAGALLERY_CREATED",r.created));var b="";if(r.show_modified==1)b=e("<div>",{"class":"rsmg_calendar rsmg_toolbox"}).html(rsmg_get_lang("COM_RSMEDIAGALLERY_MODIFIED",r.modified));var w="";if(r.show_tags==1)w=e("<p>",{"class":"rsmg_tags"}).html(rsmg_get_lang("COM_RSMEDIAGALLERY_TAGS")+": <strong>"+r.tags+"</strong>");var E=e("<span>",{"class":"rsmg_clear"});var S=e("<span>",{"class":"rsmg_clear"});v.append(E,m,g,y,b,S,w);if(responsive){a.append(f.append(l));if(p!="")a.append(p.append(h));if(d!="")a.append(d);a.append(v);u.append(a)}else{u.append(a.append(l,h,d,v))}o.append(u);i++});rsmg_init_items_loaded(e,s,responsive);if(n!=0){e("#rsmg_gallery").mixitup("remix","all");rsmg_set_tags_filters(e)}var u=rsmg_get_original_limitstart(e);if(t.total>e("ul#rsmg_gallery").children().length+u){var a=t.total-(e("ul#rsmg_gallery").children().length+u);e("#rsmg_load_more").html(rsmg_get_lang("COM_RSMEDIAGALLERY_LOAD_MORE",a));e("#rsmg_load_more").attr("rel",a);e("#rsmg_load_more").fadeIn(500)}else e("#rsmg_load_more").attr("rel",0);if(typeof r=="function"){r(t)}}}})}function rsmg_init_items_loaded(e,t,n){var r=e("#rsmg_gallery_filters").length;var i=t.length;var s=0;if(!n)var o=e("#rsmg_gallery li .rsmg_item_container img");else var o=e("#rsmg_gallery li .rsmg_item_container .rsmg_image img");o.each(function(){var n=e(this).attr("src");if(inArray(n,t)){e(this).load(function(){s++;if(s==i){rsmg_init_items(e,r)}})}})}function rsmg_hit_item(e){cid=parseInt(jQuery("#lightbox-image").attr("rel"));if(!isNaN(cid)&&cid>0&&rsmg_hit.indexOf(cid)==-1){rsmg_hit.push(cid);rsmg_to_hit.push(cid);if(rsmg_hit_timer)clearTimeout(rsmg_hit_timer);rsmg_hit_timer=setTimeout(function(){jQuery.ajax({type:"POST",url:rsmg_get_root()+"/index.php",data:{option:"com_rsmediagallery",task:"hititem",cid:rsmg_to_hit}});rsmg_to_hit.length=0},2500)}}jQuery(document).ready(function(e){if(e("#rsmg_prev_page").length>0)e("#rsmg_prev_page").hide();var t=e("#rsmg_gallery_filters").length;rsmg_init_load_more(e);var n=false;if(typeof albumview!="undefined"){n=true}if(responsive&&!t&&!n){e("#rsmg_main").hide();e(window).load(function(){e("#rsmg_main").show();rsmg_init_items(e,t)})}else if(responsive&&t&&!n){e(window).load(function(){rsmg_init_items(e,t)})}else{rsmg_init_items(e,t)}rsmg_set_tags_filters(e);if(n){rsmg_check_width(e)}var r=false;if(typeof center_albums!="undefined"&&center_albums){rsmg_center_albums(e);r=true}if(center_list||responsive){e(window).resize(function(){if(center_list)rsmg_align_center(e,false);if(responsive)rsmg_equal_size_responsive(e,false,0);if(n){rsmg_check_width(e)}if(r){rsmg_center_albums(e)}})}var i=e("#rsmg_image_container img").attr("src");if(e.browser.msie&&e.browser.version<9){i+=i.indexOf("?")==-1?"?":"&";i+="random="+Math.floor(Math.random()*11e3)}e("#rsmg_loader_container").removeAttr("style");var s=e("<img>").load(function(){if(e("#rsmg_thumb_container > img").outerWidth()>e("#rsmg_image_container").parent().outerWidth())e("#rsmg_image_container img").css("width","100%");e("#rsmg_loader_container").remove();e("#rsmg_image_container").removeClass("rsmg_hidden_from_view");e("#rsmg_image_container img").hide().fadeIn(700)}).attr("src",i)});var rsmg_lang_vars={};var rsmg_hit=[];var rsmg_to_hit=[];var rsmg_hit_timer=false